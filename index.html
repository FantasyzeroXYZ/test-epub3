<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPUBÈòÖËØªÂô® (Multi-column ÂàÜÈ°µÁâà)</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- ÁõÆÂΩï‰æßËæπÊ†è -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>ÁõÆÂΩï</h2>
                <button class="btn btn-outline" id="closeSidebar">ÂÖ≥Èó≠</button>
            </div>
            <div class="book-info">
                <div class="book-title" id="bookTitle">EPUB ÈòÖËØªÂô®</div>
                <div class="book-author" id="bookAuthor">ËØ∑‰∏ä‰º†EPUBÊñá‰ª∂</div>
            </div>
            <div class="toc-container" id="tocContainer"></div>
        </div>

        <div class="main-content">
            <!-- È°∂ÈÉ®Â∑•ÂÖ∑Ê†è -->
            <div class="reader-header">
                <div class="header-top-row">
                    <div class="function-buttons">
                        <button class="btn" id="menuToggle">
                            <span>üìñ</span>
                            <span>ÁõÆÂΩï</span>
                        </button>
                        <button class="btn btn-outline" id="uploadBtn">
                            <span>üìÅ</span>
                            <span>‰∏ä‰º†</span>
                        </button>
                        <!-- ËÆæÁΩÆÊåâÈíÆ -->
                        <button class="btn" id="toggleSettings">
                            <span>‚öôÔ∏è</span>
                            <span>ËÆæÁΩÆ</span>
                        </button>
                    </div>
                    <div class="header-controls">
                        <span class="page-indicator">Á¨¨ <span id="currentPage">1</span> È°µ / ÂÖ± <span id="totalPages">?</span> È°µ</span>
                    </div>
                </div>
                <div class="header-bottom-row">
                    <button class="btn btn-outline" id="prevPage">‚¨ÖÔ∏è</button>
                    <button class="btn btn-outline" id="nextPage">‚û°Ô∏è</button>
                </div>
            </div>

            <!-- EPUB ÊòæÁ§∫Âå∫Âüü -->
            <div class="epub-display-area">
                <div class="book-container" id="bookContainer">
                    <div class="content-wrapper" id="contentWrapper">
                        <div class="adaptive-content" id="adaptiveContent">
                            <div class="no-content">
                                <h1>üìö EPUB ÈòÖËØªÂô®</h1>
                                <p>ËØ∑ÈÄâÊã© EPUB Êñá‰ª∂ÂºÄÂßãÈòÖËØª</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÁøªÈ°µÂå∫Âüü -->
                <div class="swipe-area left-swipe" id="prevSwipeArea"></div>
                <div class="swipe-area right-swipe" id="nextSwipeArea"></div>
            </div>

            <!-- Èü≥È¢ëÊí≠ÊîæÂô® -->
            <div class="player-container" id="playerContainer" style="display: none;">
                <div class="player-controls">
                    <button class="player-btn" id="playPauseBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="progress-container">
                        <span class="time-display" id="currentTime">0:00</span>
                        <div class="progress-bar" id="progressBar">
                            <div class="progress" id="progress"></div>
                        </div>
                        <span class="time-display" id="duration">0:00</span>
                    </div>
                    <select class="playback-rate" id="playbackRate">
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="2">2x</option>
                    </select>
                </div>
            </div>
            
            <!-- ËØçÂÖ∏ÂºπÁ™ó -->
            <div class="dictionary-modal" id="dictionaryModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>ËØçÂÖ∏Êü•ËØ¢</h3>
                        <button id="closeDictionary">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body" id="dictionaryContent">
                        <!-- ËØçÂÖ∏ÂÜÖÂÆπÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                    </div>
                    <div class="modal-footer" id="dictionaryFooter">
                        <button id="addToAnkiBtn" class="btn-primary">
                            <i class="fas fa-graduation-cap"></i> Ê∑ªÂä†Âà∞Anki
                        </button>
                        <button id="closeDictionaryBtn" class="btn-secondary">
                            ÂÖ≥Èó≠
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- ÈÄâÊã©Â∑•ÂÖ∑Ê†è -->
            <div class="selection-toolbar" id="selectionToolbar">
                <button id="lookupWordBtn" class="toolbar-btn">
                    <i class="fas fa-book"></i> Êü•ËØç
                </button>
                <button id="highlightBtn" class="toolbar-btn">
                    <i class="fas fa-highlighter"></i> È´ò‰∫Æ
                </button>
                <button id="addToAnkiQuickBtn" class="toolbar-btn">
                    <i class="fas fa-graduation-cap"></i> AnkiÂà∂Âç°
                </button>
                <button id="copyBtn" class="toolbar-btn">
                    <i class="fas fa-copy"></i> Â§çÂà∂
                </button>
            </div>
            
            <!-- ÈÅÆÁΩ©Â±Ç -->
            <div class="overlay" id="overlay"></div>
            
            <!-- Âä†ËΩΩÊåáÁ§∫Âô® -->
            <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                <div class="spinner"></div>
                <p>Âä†ËΩΩ‰∏≠...</p>
            </div>
        </div>

        <!-- ËÆæÁΩÆ‰æßËæπÊ†è -->
        <div class="settings-sidebar" id="settingsSidebar">
            <div class="settings-header">
                <h2>ËÆæÁΩÆ</h2>
                <button class="btn btn-outline" id="closeSettings">ÂÖ≥Èó≠</button>
            </div>
            <div class="settings-content">
                <div class="setting-group">
                    <div class="setting-group-header" data-group="reading">
                        <h3>üìñ ÈòÖËØªËÆæÁΩÆ</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="setting-group-content" id="readingSettings">
                        <div class="setting-item">
                            <span class="setting-label">Â≠ó‰ΩìÂ§ßÂ∞è</span>
                            <div class="setting-control">
                                <select class="select-control" id="fontSize">
                                    <option value="small">Â∞è</option>
                                    <option value="medium" selected>‰∏≠</option>
                                    <option value="large">Â§ß</option>
                                    <option value="xlarge">ÁâπÂ§ß</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">‰∏ªÈ¢ò</span>
                            <div class="setting-control">
                                <select class="select-control" id="theme">
                                    <option value="light" selected>ÊµÖËâ≤</option>
                                    <option value="dark">Ê∑±Ëâ≤</option>
                                    <option value="sepia">Êä§Áúº</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <div class="setting-group-header" data-group="audio">
                        <h3>üîä Èü≥È¢ëËÆæÁΩÆ</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="setting-group-content" id="audioSettings">
                        <div class="setting-item">
                            <span class="setting-label">Ëá™Âä®Êí≠Êîæ</span>
                            <div class="setting-control">
                                <label class="switch">
                                    <input type="checkbox" id="autoPlay" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">ÊúóËØªÈÄüÂ∫¶</span>
                            <div class="setting-control">
                                <select class="select-control" id="speechRate">
                                    <option value="0.5">0.5x</option>
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- AnkiËÆæÁΩÆÈÉ®ÂàÜ -->
                <div class="setting-group">
                    <div class="setting-group-header" data-group="anki">
                        <h3>üìö AnkiËÆæÁΩÆ</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="setting-group-content" id="ankiSettings">
                        <div class="setting-item">
                            <span class="setting-label">AnkiConnect</span>
                            <div class="setting-control">
                                <button class="btn btn-outline" id="testAnkiConnection">ÊµãËØïËøûÊé•</button>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">IPÂú∞ÂùÄ</span>
                            <div class="setting-control">
                                <input type="text" class="input-control" id="ankiHost" placeholder="127.0.0.1" value="127.0.0.1">
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Á´ØÂè£</span>
                            <div class="setting-control">
                                <input type="number" class="input-control" id="ankiPort" placeholder="8765" value="8765">
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">ÁâåÁªÑ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiDeck">
                                    <option value="">ÈÄâÊã©ÁâåÁªÑ</option>
                                </select>
                                <span class="loading-text" id="deckLoading" style="display: none; font-size: 0.8rem; color: #666;">Âä†ËΩΩ‰∏≠...</span>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Ê®°Êùø</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiModel">
                                    <option value="">ÈÄâÊã©Ê®°Êùø</option>
                                </select>
                                <span class="loading-text" id="modelLoading" style="display: none; font-size: 0.8rem; color: #666;">Âä†ËΩΩ‰∏≠...</span>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">ÂçïËØçÂ≠óÊÆµ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiWordField">
                                    <option value="">ÈÄâÊã©Â≠óÊÆµ</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Èáä‰πâÂ≠óÊÆµ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiMeaningField">
                                    <option value="">ÈÄâÊã©Â≠óÊÆµ</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Âè•Â≠êÂ≠óÊÆµ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiSentenceField">
                                    <option value="">ÈÄâÊã©Â≠óÊÆµ</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Èü≥È¢ëÂ≠óÊÆµ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiAudioField">
                                    <option value="">ÈÄâÊã©Â≠óÊÆµ</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Ê†áÁ≠æÂ≠óÊÆµ</span>
                            <div class="setting-control">
                                <select class="select-control" id="ankiTagsField">
                                    <option value="">ÈÄâÊã©Â≠óÊÆµ</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item">
                            <button class="btn" id="saveAnkiSettings">‰øùÂ≠òËÆæÁΩÆ</button>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <div class="setting-group-header" data-group="advanced">
                        <h3>‚öôÔ∏è È´òÁ∫ßËÆæÁΩÆ</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="setting-group-content" id="advancedSettings">
                        <div class="setting-item">
                            <span class="setting-label">ÂêØÁî®Á¶ªÁ∫øÊ®°Âºè</span>
                            <div class="setting-control">
                                <label class="switch">
                                    <input type="checkbox" id="offlineMode">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">ÂêåÊ≠•ÈòÖËØªËøõÂ∫¶</span>
                            <div class="setting-control">
                                <label class="switch">
                                    <input type="checkbox" id="syncProgress" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <div class="setting-group-header" data-group="data">
                        <h3>üíæ Êï∞ÊçÆÁÆ°ÁêÜ</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="setting-group-content" id="dataSettings">
                        <div class="setting-item">
                            <button class="btn btn-outline" id="exportData">ÂØºÂá∫ÈòÖËØªÊï∞ÊçÆ</button>
                        </div>
                        <div class="setting-item">
                            <button class="btn btn-outline" id="clearData">Ê∏ÖÈô§ÁºìÂ≠ò</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Êñá‰ª∂ÈÄâÊã©Âô®ÔºàÈöêËóèÔºâ -->
    <input type="file" id="epubFile" accept=".epub" style="display: none;" />

    <!-- ÂºïÂÖ•JSZipÂ∫ìÁî®‰∫éËß£ÂéãEPUB -->
    <script src="lib/jszip.min.js"></script>
    <script src="js/script.js"></script>
</body>
</html>